[workspace]
name = "pixi-emacs"
description = "Doom Emacs dev environment via Pixi â€” no Docker, no system packages"
version = "0.1.0"
platforms = ["osx-arm64", "osx-64", "linux-64", "linux-aarch64"]
channels = ["conda-forge"]

[dependencies]
# Runtime deps for Doom Emacs
git = "*"
ripgrep = "*"
fd-find = "*"
libvterm = "*"
cmake = "*"

# Terminal environment
zellij = "*"
atuin = "*"
direnv = "*"
fish = "*"

# Language toolchains
go = "*"
nodejs = "*"

# Build deps for compiling Emacs from source
autoconf = "*"
automake = "*"
make = "*"
pkg-config = "*"
texinfo = "*"
ncurses = "*"
gnutls = "*"
libxml2 = "*"
libtree-sitter = "<0.24"
libglib = "*"
libjpeg-turbo = "*"
giflib = "*"
libtiff = "*"
libpng = "*"

[tasks]
build-emacs = "bash scripts/build-emacs.sh"
install-clojure-tools = "bash scripts/install-clojure-tools.sh"
install-claude-code = "bash scripts/install-claude-code.sh"
install-doom = { cmd = "bash scripts/install-doom.sh", depends-on = ["build-emacs"] }
setup = { cmd = "echo ok", depends-on = ["doom-sync", "install-clojure-tools", "install-claude-code"] }
doom-sync = "DOOMDIR=$PIXI_PROJECT_ROOT/.doom.d EMACSDIR=$PIXI_PROJECT_ROOT/.doomemacs $PIXI_PROJECT_ROOT/.doomemacs/bin/doom sync"
emacs = "TERMINFO_DIRS=$CONDA_PREFIX/share/terminfo:/usr/share/terminfo:/usr/lib/terminfo XDG_CONFIG_HOME=$PIXI_PROJECT_ROOT/config DOOMDIR=$PIXI_PROJECT_ROOT/.doom.d EMACSDIR=$PIXI_PROJECT_ROOT/.doomemacs emacs -nw --init-directory=$PIXI_PROJECT_ROOT/.doomemacs"
ze = "TERMINFO_DIRS=$CONDA_PREFIX/share/terminfo:/usr/share/terminfo:/usr/lib/terminfo XDG_CONFIG_HOME=$PIXI_PROJECT_ROOT/config SHELL=$(which fish) zellij --config $PIXI_PROJECT_ROOT/config/zellij/config.kdl attach --create pixi-emacs"
